<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assignment 2 | Analise de Sequencias Biologicas</title>

    <link rel="stylesheet" href="css/style.css">

    <!--box icons-->
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">

</head>
<body>

    <!--header design -->
    <header class="header">
        <a href="#" class="logo">Assignment2</a>

        <div class="bx bx-menu" id="menu-icon"></div>

        <nav class="navbar">
            <a href="#home" class="active">Home</a>
            <a href="#introduction">Introduction</a>
            <a href="#objectives">Objectives</a>
            <a href="#material">Materials</a>
            <a href="#results">Results</a>
            <a href="#discussion">Discussion</a>

            <span class="active-nav"></span>
        </nav>
    </header>

    <!--home section design-->
    <section class="home" id="home">
        <div class="home-content">
            <h1>Assignment <span>2</span></h1>
            <div class="text-animate">
                <h3>Analise de Sequencias Biologicas</h3>
            </div>
            <p>Data: 30/06/2023<br>
                Docente: Francisco Martins Pina
            </p>

            <div class="btn-box">
                <a href="studentpg.html" class="btn">Students</a>
                <a href="authors.html" class="btn">Authors Contr.</a>
            </div>
        </div>

        <div class="home-imgHover"></div>
    </section>

    <!--introduction section design. Criar outra section-->
    <section class="introduction" id="introduction">
        <h2 class="heading">Introduction</h2>

        <div class="intro-content">
            <p style="font-size: 15px;">O artigo em estudo concentra-se na diversidade e ecologia das espécies de carvalho encontradas na Província Florestal da Califórnia, a Província Florestal da Califórnia é uma região nos Estados Unidos da América famosa pela sua  biodiversidade, que inclui muitas espécies de carvalho. Estas árvores contribuem para a saúde do ecossistema e fornecem habitat para uma variedade de organismos, tornando-as essenciais para os ecossistemas locais.</p>
            <p style="font-size: 15px;">O objetivo da pesquisa é investigar os padrões e os momentos na história que geraram a diversidade genética e a estrutura da população das espécies de carvalho encontradas nesta área usando técnicas de genómica e bioinformática, os pesquisadores analisaram  sequencias de DNA  nuclear e dados morfométricos de várias espécies de carvalho para descobrir as relações filogenéticas e a organização geográfica das populações.</p>
            <p style="font-size: 15px;">Um ponto a ser destacado do artigo é a pipeline de bioinformática utilizada para analisar os dados recolhidos no estudo, a primeira etapa consistiu na Sampling and preparation das amostras de carvalhos vermelhos da Califórnia Florestal onde o processo de recolha e preparação de amostras para o estudo é descrito. Amostras de todas as espécies de Agrifoliae encontradas na Califórnia foram recolhidas, mas o foco foi para o carvalho Q. kelloggii, que é simpátrico com as subespécies de Agrifoliae. Análises mostraram que Q. kelloggii estava associado a Q. wislizeni, Q. parvula var. shrevei, Q. agrifolia var. agrifolia e Q. agrifolia var. oxyadenia em locais diferentes. Cada local foi cercado com três árvores, separadas por mais de 50 metros. Desenvolveram uma chave taxonômica por meio de análises morfométricas e estudos taxonómicos <a href="https://bsapubs.onlinelibrary.wiley.com/doi/full/10.3732/ajb.1700291" style="color: #00abf0;">Hauser et al. 2017</a>. Em seguida, foram realizadas as Morphometric Analysis, para as análises morfométricas, foram efetuadas análises morfométricas em 73 árvores e arbustos em locais à sombra e ao sol para estudar as variações morfológicas. Foram recolhidos dados de sequência de ADN para 48 espécimes e as características das folhas foram medidas utilizando imagens online de espécimes-tipo. Foram desenvolvidos dois conjuntos de características: um centrado nas características dos frutos e das folhas, e outro nas características das folhas nos casos em que não havia amostras de frutos disponíveis. O estudo envolveu 73 árvores e arbustos, com 48 espécimes examinados e dados de sequência de ADN recolhidos para 48.</p>
            <p style="font-size: 15px;">Após a Mophometric analysis recorreram a DNA extraction and sequencing onde as amostras de tecido vegetal fresco foram entregues e mantidas a uma temperatura baixa (-80 °C). O método CTAB foi modificado para extrair o ADN, tendo sido utilizado o surfactante sarkosyl no processo. Se as amostras contivessem contaminantes ou impurezas, o sorbitol era utilizado como agente de limpeza num processo de extração modificado. Os extractos de ADN resultantes foram medidos e foi utilizada a eletroforese em gel de agarose para avaliar a sua qualidade. O ADN foi então entregue à Floragenex para ser utilizado na criação e sequenciação de bibliotecas RAD-Seq. As bibliotecas foram sequenciadas na plataforma Illumina HiSEq. 2500, e a digestão foi efectuada utilizando a enzima de restrição PstI.</p>
            <p style="font-size: 15px;">Seguidamente deu-se a Data processing onde o programa pyRAD 3.0.66 foi usado para processar arquivos de sequências brutas usando parâmetros padrão de qualidade, agrupamento e profundidade. Os arquivos foram de-multiplexed, o que permitiu até um desvio da barcode sequence. Além disso, as leituras com mais de quatro sites de baixa qualidade (Phred < 20) foram filtradas antes de serem agrupadas. Para o conjunto completo de dados concatenados, as leituras limpas foram agrupadas com uma identidade de 88%, uma profundidade de agrupamento mínima de seis leituras entre as amostras individuais e uma profundidade de agrupamento mínima de quatro amostras entre elas. <a href="https://bsapubs.onlinelibrary.wiley.com/doi/full/10.3732/ajb.1700291" style="color: #00abf0;">Hauser et al. 2017</a></p>
            <p style="font-size: 15px;">Em seguida deu-se a Phylogenetic estimation na qual foi utilizado o programa RAxML GUI 1.5b1 em conjunto com a versão PThread do RAxML 8.1.21 para realizar a análise filogenética de Maximum Likelihood. Um conjunto de dados de todas as amostras sequenciadas dos Agrifoliae, juntamente com amostras de Lobatae e Protobalanus foi usado para criar uma árvore para avaliar a monofilia dos Agrifoliae. Para as análises seguintes, foi utilizado um conjunto de dados filtrado, essas análises incluíram apenas amostras de Agrifoliae com mais de 200.000 leituras, a árvore foi identificada como pertencente à clade Q. kelloggii. O GTRCAT, ou modelo geral de substituição nucleofílica com heterogeneidade de taxas, foi usado como modelo evolutivo. Avaliamos o suporte para os resultados usando cem replicas de bootstrap não paramétricas, onde o FigTree 1.4.2 foi usado para visualizar e o Inkscape 0.91 para formatar os arquivos da árvore. <a href="https://bsapubs.onlinelibrary.wiley.com/doi/full/10.3732/ajb.1700291" style="color: #00abf0;">Hauser et al. 2017</a></p>
            <p style="font-size: 15px;">Para a Structure analysis o programa Structure 2.3.4 foi usado para analisar arquivos de estrutura criados no pyRAD para loci SNP supostamente não ligados, para evitar dados em falta, foram usados data sets partilhados por pelo menos 70% das amostras. As análises de estrutura para vários data sets foram realizadas usando 100.000 gerações de Monte Carlo (MCMC) e a escolha do número ideal de agrupamentos com base na probabilidade logarítmica. <a href="https://bsapubs.onlinelibrary.wiley.com/doi/full/10.3732/ajb.1700291" style="color: #00abf0;">Hauser et al. 2017</a></p>
            <p style="font-size: 15px;">Por fim, a Dating analysis para calcular os tempos de divergência dentro do grupo Agrifoliae, foi utilizado um modelo bayesiano chamado BEAST v2.4.4. Os dados de pesquisa incluíram 12 exemplares de Agrifoliae selecionados com base na pureza genética das análises de estrutura. Além disso, um exemplar de Protobalanus e três exemplares de outras linhagens de carvalho vermelho foram incluídos no estudo. A fim de otimizar a eficiência computacional, um conjunto de dados menor contendo loci compartilhados (1939 loci) foi utilizado. As árvores filogenéticas foram calibradas usando pontos de calibração fóssil e, para avaliar a consistência dos resultados, foram realizadas três repetições. A cadeia de MCMC (Cadeia de Markov Monte Carlo) foi executada por 100 milhões de gerações, sem um período de burn-in específico. Além disso, foram realizadas análises adicionais com critérios de inclusão de loci variados para avaliar possíveis vieses nas estimativas de datação.</p>
            <img src="Images/PipelineASB4.png" alt="">
            <figcaption style="font-size: 10px;">Figura 1 - (1) Recolher as amostras das espécies Q. kelloggii, a Q. wislizeni, Q. parvula var. shrevei, Q. agrifolia var. agrifolia e Q. agrifolia var. oxyadenia. (2) Análises morfométricas em 73 árvores e arbustos em locais à sombra e ao sol para estudar as variações morfológicas. (3) Extração do DNA das amostras e sequenciação do mesmo na plataforma Ilumina HiSEq. 2500. (4) processamento arquivos de sequências brutas usando parâmetros padrão de qualidade, agrupamento e profundidade e de-multiplex dos mesmos. (5) Análise filogenética dos dados obtidos e construção da árvore de Maximum Likelihood. (6) Analise dos arquivos de estrutura criados no pyRAD para loci SNP supostamente não ligados. (7) Calcular os tempos de divergência dentro do grupo Agrifoliae através do modelo bayesiano.</figcaption>
            <br>
            <br>
            <br>
            <p style="font-size: 15px;">Por fim, os autores do artigo chegaram à conclusão de que a evolução da subsecção de carvalhos Agrifoliae, que é encontrada no oeste da América do Norte, mostra um padrão complicado de mudanças e mudanças na distribuição geográfica ao longo do tempo, que foram influenciados pelo clima. Ao trabalhar com dados fósseis, a análise filogenética nos dá uma melhor compreensão de como esses carvalhos se diversificaram e se adaptaram a diferentes ambientes.</p>
            <p style="font-size: 15px;">A variação genética no clade dos carvalhos subperenifólia é notável, isso ajuda a apoiar a taxonomia existente, identificando padrões de diferenciação entre as espécies em termos de distribuição geográfica. Por exemplo, as espécies Q. parvula e Q. wislizeni têm um padrão leste-oeste, sugerindo uma divisão ao longo do tempo. Além disso, todas as espécies da ordem Agrifoliae mostram diferentes graus de estruturação geográfica em direção ao norte-sul.</p>
            <p style="font-size: 15px;">O outro elemento significativo encontrado neste estudo é a existência de zonas de hibridação, em particular, a região ao norte de San Francisco possui uma população híbrida de Q. parvula var. shrevei e Q. wislizeni. Também foram encontradas amostras de Q. parvula var. tamalpaisensis, os resultados sugerem que Q. parvula var. tamalpaisensis é provavelmente um híbrido de Q. wislizeni e, portanto, não deve ser considerado uma espécie separada.</p>

        </div>
    </section>

    <!-- objectives section design. " " -->
    <section class="objectives" id="objectives">
        <h2 class="heading">Objectives</h2>

        <div class="obj-content">
            <p style="font-size: 15px;">Seguindo a introdução deparamo-nos com a questão: Porque isto é um problema relevante?</p>
            <p style="font-size: 15px;">Investigar acerca dos padrões que geraram a diversidade genética ao longo do tempo tem diversos benefícios tais como conservar as espécies ao mapear as relações filogenéticas entre as mesmas de modo a facilitar a proteção das espécies. No mesmo tópico, ao analisar a história evolutiva destas espécies conseguimos inferir como estas espécies se adaptaram às diversas mudanças ambientais, sendo esta informação essencial para prever a reação das espécies para futuras mudanças climatéricas. Por fim, uma vantagem deste artigo, como em muitos dos artigos publicados é fornecer bases que podem ser utilizadas como referência em futuros artigos, facilitando e comprovando os mesmos.</p>
            <p style="font-size: 15px;">Contudo, o objetivo do nosso artigo é diferente do artigo original, sendo esse:</p>
            <ul style="font-size: 15px;">
                <li style="margin-left: 25px;">Replicar os resultados do artigo original
                    <ul>
                        <li style="margin-left: 25px;" style="font-size: 15px;">Para tal efeito começamos com a task de Sampling Data, em que selecionamos os dados utilizados no artigo. Para esta task a skill necessária para a sua execução foi a de leitura do artigo original e identificação dos dados usados no mesmo.</li>
                        <li style="margin-left: 25px;" style="font-size: 15px;">Com a nossa amostra selecionada passamos à task de SRA Extraction, onde usufruímos do site NCBI para extrair os dados de sequenciação referentes às amostras selecionadas no passo anterior. Para esta task foi necessário um conhecimento prévio de como navegar a base de dados do NCBI.</li>
                        <li style="margin-left: 25px;" style="font-size: 15px;">Com os dados recolhidos podemos executar a task do Rad-seq onde nos servimos da ferramenta ipyrad para obter os ficheiros necessários para as analises pretendidas. Para esta task é necessário conhecimento de como utilizar a ferramenta ipyrad, especialmente como ajustar o ficheiro de parâmetros e ter a capacidade de perceber quais dos outputs gerados pela ferramenta são necessários para o nosso estudo.</li>
                        <li style="margin-left: 25px;" style="font-size: 15px;">Após os resultados do ipyrad obtivemos vários ficheiros como output, sendo um deles o ficheiro VCF, essencial para realizar a próxima task denominada PCA (Principal Component Analysis) para efetuarmos um estudo de como as nossas amostras se agrupam entre si. Para esta task foi necessário um conhecimento da linguagem de programção R, nomeadamente de como construir um Data Frame e fazer plots dos nossos dados.</li>
                        <li style="margin-left: 25px;" style="font-size: 15px;">Outro dos outputs fornecidos pelo ipyrad possibilitou a realização da task STRUCTURE onde construímos um plot de admixture. Para esta task a skill necessária foi o conhecimento para construir o ficheiro indfile.</li>
                        <li style="margin-left: 25px;" style="font-size: 15px;">Por fim, usufruindo do ficheiro phylip obtido em output através do ipyrad podemos construir uma arvore de Maximum Likelihood. Para esta task foi necessário conhecimento prévio das ferramentas RaxML, MrBayes e Toytree.</li>

                    </ul>
                </li>
            </ul>

        </div>
    </section>

    <!-- Material and Methods section design. " " -->
    <section class="material" id="material">
        <h2 class="heading">Materials & Methods</h2>

        <div class="mat-content">
            <p style="font-size: 15px;"><strong>Sampling the data - </strong>Este estudo teve como objetivo coletar amostras de todas as espécies pertencentes ao grupo Agrifoliae nas suas áreas de distribuição na Califórnia. O grupo Agrifoliae é composto por várias espécies de carvalhos nativos da região. Foram selecionadas algumas espécies-chave para este estudo. A primeira delas é o Quercus kelloggii, conhecido como. Além disso, foram incluídas duas variações do Quercus agrifolia. Essas variações são o Quercus agrifolia var. agrifolia e o Quercus agrifolia var. oxyadenia. Outra espécie incluída neste estudo foi o Quercus parvula. Assim como as variações do Quercus agrifolia, o Quercus parvula possui duas variações: Quercus parvula var. shrevei e Quercus parvula var. tamalpaisensis. A espécie Quercus wislizeni, também foi incluída no estudo. Por fim, foram estudadas três espécies híbridas do grupo Agrifoliae: Quercus x chasei, Quercus x ganderi e Quercus x morehus. No total, foram coletadas 55 amostras das espécies mencionadas.</p>
            <p style="font-size: 15px;"><strong>SRA extraction - </strong>No artigo utilizado como referência para este estudo, tivemos acesso ao BioProject <a href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA376740" style="color: #00abf0;">(PRJNA376740)</a> que continha as amostras que seriam utilizadas na investigação. Para extrair os dados necessários, utilizámos a plataforma do <a href="https://www.ncbi.nlm.nih.gov" style="color: #00abf0;">NCBI</a> na secção "BioProject" para localizar os SRAs correspondentes a cada amostra que estava a ser analisada. O BioProject fornecido continha mais de 500 SRAs de diferentes espécies de carvalho. No entanto, para o nosso estudo, selecionámos apenas 55 SRAs que correspondiam às espécies específicas em análise. A extração dos SRAs foi realizada através do <em>software</em> do <a href="https://github.com/ncbi/sra-tools" style="color: #00abf0;">sra-tools</a> Porém para fazer a extração dos arquivos utilizamos a ferramenta do sra-tools o fasterq-dump. O fasterq-dump é uma ferramenta que facilita e simplifica a extração dos dados e metadados para um formato fastq, como menciona<a href="https://www.biorxiv.org/content/10.1101/2023.04.19.537508v1.abstract" style="color: #00abf0;"> Maria Clicia Castro et al</a> em seu estudo sobre CellHeap. Porém para realizar o fasterq-dump precisaríamos fazer 55 vezes o mesmo código, portanto realizamos uma automatização do fasterq-dump que extraia os arquivos de uma vez só. Entretanto como os ficheiros das nossas amostras em estudo estavam distribuídas de forma aleatória pelo BioProject, tivemos de escrever os SRAs um a um no script para especificar quais arquivos queremos extrair. Depois te der sido realizada a extração dos dados realizamos um corte em todos os fastq das amostras extraídas, para tal aplicamos um script em Shell para o corte dos ficheiros fastq. O corte que realizamos foi de 15000 reads. O objetivo deste método foi obter os ficheiros fastq. Os scripts utilizados e os processos de como foi realizado este método está disponível no <a target="_blank" href="https://github.com/jonnymoretti/ScriptsCodes_Assignment2" style="color: #00abf0;">GitHub</a>.</p>
            <p style="font-size: 15px;"><strong>RAD-Seq data - </strong>Para realizar este estudo, utilizámos uma abordagem chamada RAD-Seq (Restriction-site Associated DNA Sequencing), que é um método eficiente para reduzir a quantidade de variação genómica presente nas amostras analisadas. Este método permite agrupar a variação de todo o genoma, selecionando uma pequena fração do custo total de sequenciação genómica. A utilização do RAD-Seq oferece várias vantagens. Em primeiro lugar, permite a análise de um grande número de loci genómicos de forma eficiente, proporcionando uma cobertura abrangente da variação genética presente nas amostras. Além disso, esta abordagem oferece uma maior resolução em comparação com outras técnicas, permitindo a deteção de variações genéticas em diferentes níveis, como variações entre populações, indivíduos e até mesmo dentro de um único genoma. No nosso estudo, utilizámos o software ipyrad v.0.9.92 que é uma ferramenta interativa de montagem e analise para ADN associados a sítios de restrição (RAD-Seq) e tipos de dados relacionados. Para mais informação sobre o que é e como funciona o ipyrad consulte a sua <a href="https://ipyrad.readthedocs.io/en/master/" style="color: #00abf0;">documentação</a>. O ipyrad foi realizado em 7 etapas e utilizaremos os ficheiros fastq que foram obtidos no fasterq-dump. A primeira etapa foi o <em>Demultiplexing the raw data</em>, não realizamos esta etapa pois não houve necessidade, isto é, nossos dados brutos já se encontravam cortados. Na segunda etapa fizemos a filtração dos dados com base nas pontuações de qualidade e no número máximo de bases não utilizadas, no qual utilizamos nossa <em>max low quality</em> base foi 4 e o nosso <em>clustering threashold</em> foi de 88%. A terceira etapa foi o <em>clustering within-samples</em> A quarta e quinta etapa foi <em>Joint estimation of heterozygosity and error rate</em> e <em>Consensus base calls</em> respetivamente. A sexta e sétima etapa deste método foi <em>Cluster across samples</em> e <em>Filter and writer outputs files</em> respetivamente. O objetivo deste método foi o de obter os ficheiros VCF, geno, STRUCTURE, phyllip, nexus e entre outros, porém estes ficheiros em questão são os essenciais, pois utilizamos estes ficheiros no decorrer do estudo. Para mais informação detalhadas sobre os procedimentos de como foi realizado e quais foram os códigos utilizados estão presentes no <a target="_blank" href="https://github.com/jonnymoretti/ScriptsCodes_Assignment2" style="color: #00abf0;">GitHub</a>.<br> Para a realização do ipyrad é fundamental ter o miniconda instalado corretamente na VM, caso não tenha instalado o miniconda na VM, deixo disponibilizado um tutorial de como fazer a instalação do <a target="_blank" href="https://github.com/jonnymoretti/ScriptsCodes_Assignment2/blob/main/miniconda.md" style="color: #00abf0;">miniconda3</a> de maneira correta.</p>
            <p style="font-size: 15px;"><strong>PCA analysis - </strong>No método utilizado neste estudo, buscamos reduzir a dimensionalidade dos dados, mantendo a maior parte da informação original. Essa abordagem nos permitiu analisar de forma mais prática conjuntos de dados complexos e identificar tendências significativas. Ao reduzir a dimensionalidade, podemos visualizar e interpretar os dados de maneira mais eficiente. A PCA procura determinar a base mais significativa para a reexpressão de um determinado conjunto de dados <a href="https://link.springer.com/referenceworkentry/10.1007/978-3-030-03243-2_649-1" style="color: #00abf0;">(Takio Kurita)</a> Para realizar a construção do gráfico de PCA, desenvolvemos um script em R utilizando o programa RStudio v.4.2.1. O script que realizamos recorremos a dois ficheiros o VCF e o geno. O ficheiro geno foi utilizado para calcular o PCA, enquanto o ficheiro VCF foi utilizado para colorir os clusters de acordo com as populações das espécies. O RStudio é uma poderosa ferramenta de desenvolvimento e análise estatística, amplamente utilizada pela comunidade científica. Com o auxílio do R e do RStudio, pudemos implementar o script necessário para gerar os gráficos do PCA, ou seja, neste método realizamos dois gráficos de PCA, um gráfico foi realizado para a <em>Leaf + Fruit</em> e o outro gráfico foi realizado para <em>Only Leaf</em>. O script do R está disponível no <a target="_blank" href="https://github.com/jonnymoretti/ScriptsCodes_Assignment2" style="color: #00abf0;">GitHub</a> para mais informações.</p>
            <p style="font-size: 15px;"><strong>STRUCTURE analysis - </strong>A inferência da estrutura da população em grandes conjuntos de dados impõe grandes desafios computacionais <a href="https://academic.oup.com/genetics/article/197/2/573/6074271?login=false" style="color: #00abf0;">(A. Raj, M. Stephens, and J. K. Pritchard)</a>. Para tal utilizamos softwares que nos ajudam a mitigar esses desafios computacionais, para tal utilizamos os <em>softwares</em> <em>ALStructure</em> e <em>fastStructure</em>. Nesta etapa para poder obter os gráficos de <em>Admixture</em> a partir de um conjunto de dados de SNP obtidos através do método do ipyrad utilizaremos o ficheiro VCF e o ficheiro indfile. O ficheiro indfile é composto por três colunas, a primeira coluna representa o nome da espécie, a segunda coluna representa o nome da população da espécie e a terceira coluna representa a ordem em que a população será apresentada no gráfico do <em>Admixture</em>, porém o ficheiro indfile é um ficheiro que leva algum tempo para ser feito pois é necessário que escrever tudo manualmente coluna por coluna, linha por linha, para tal realizamos uma automatização para a realização do ficheiro, no qual só é preciso escrever as espécies, o nome da população e a ordem que o script depois faz todo o resto em escrever a estrutura do indfile. Porém antes de tudo devemos saber qual é o número de <em>clusters</em> que devemos utilizar para a construção do <em>Admixture</em> e para tal utilizamos o <em>fastStructure</em>. No <em>software</em> do <em>fastStructure</em> iremos utilizar o ficheiro STRUCTURE que foi obtido também pela ferramenta do ipyrad. Depois de se ter os valores corretos de <em>clusters</em> (K) iremos realizar a construção do gráfico e para tal iremos utilizar o <em>software</em> <em>ALStructure</em> para obter o <em>Admixture</em>. Para mais informações sobre os procedimentos do código que foi realizado para fazer este método e do script do indfile utilizado estão disponíveis no <a target="_blank" href="https://github.com/jonnymoretti/ScriptsCodes_Assignment2" style="color: #00abf0;">GitHub</a>.</p>
            <p style="font-size: 15px;"><strong>Phylogenetic analysis - </strong>Nesta etapa, construímos uma árvore filogenética das amostras em estudo, avaliando a monofilia das Agrifoliae através da estimativa de uma árvore com base em um conjunto de dados que inclui todas as amostras de Agrifoliae sequenciadas. Para isso, foram estimadas filogenias de <em>Maximum Likelihood</em> utilizando o programa RAxML v.1.2.0 e o ficheiro PHYLIP que foi obtido na ferramenta do ipyrad. Também foi realizado a inferência bayesiana para obter os valores probabilísticos dos nós da árvore, para a realização do MrBayes v3.2.6 utilizamos o ficheiro NEXUS que foi obtido pela ferramenta do ipyrad e utilizamos o método Markov chain Monte Carlo (MCMC) no qual o número total de gerações foi de 600.000. Os arquivos de árvore foram processados utilizando o <em>software</em> Toytree, desenvolvido por nós, e exportados como arquivos SVG. Para mais informações sobre os procedimentos do código que foi utilizado neste método e o arquivo SVG da árvore filogenético encontram-se disponíveis no <a target="_blank" href="https://github.com/jonnymoretti/ScriptsCodes_Assignment2" style="color: #00abf0;">GitHub</a>.</p>
            <img src="Images/pipeline_metodos.png" alt="">
            <figcaption style="font-size: 10px;">Figura 2 - (1) O número de amostras recolhidas foi obtido pelo paper em estudo. (2) Extração dos fastq utilizando o <em>software</em> do sra-tools, no qual foi utilizada a ferramenta fasterq-dump. Em seguida, foi utilizado um script para realizar os cortes das reads dos arquivos fastq. (3) Foi realizado o <em>clustering</em> dos ficheiros fastq cortados no qual houve a obtenção de ficheiros que iremos utilizar no decorrer do estudo, os quais são VCF, geno, PHYLIP, NEXUS, STRUCTURE, esses ficheiros foram obtidos a partir do <em>software</em> do ipyrad que é uma ferramenta do RAD-Seq. (4) Realização do PCA no programa do RStudio, no qual foram utilizados os ficheiros geno e VCF para a construção e colorização dos gráficos do PCA. (5) Realização do gráfico de <em>Admixture</em>, que foi construído utilizando os <em>softwares</em> <em>ALSrructure</em> e <em>fastStructure</em>, com a utilização de ficheiros obtidos no método do RAD-Seq, os ficheiros utilizados foram o STRUCTURE, VCF e o indfile. (6) Construção da árvore filogenética das espécies em estudo, no qual a sua construção foi possível com a ajuda de um script em Python do ToyTree, a construção da árvore teve a utilização de dois ficheiros para a os valores de suporte e de probabilidades dos nós da árvore filogenética, os ficheiros utilizados também foram obtidos no RAD-Seq, os quais são o PHYLIP e o NEXUS.</figcaption>

        </div>
    </section>

    <!-- Results section design. " " -->
    <section class="results" id="results">
        <h2 class="heading">Results</h2>

        <div class="res-content">
            <p style="font-size: 15px;">Neste tópico, abordaremos três gráficos diferentes: PCA, Árvore filogenética e Admixture. Esses gráficos foram realizados com o objetivo de replicar os gráficos presentes no artigo em que estamos trabalhando. Os gráficos obtidos são resultados dos métodos mencionados na seção de Métodos e Materiais.</p>
            <p style="font-size: 15px;">O gráfico do PCA é uma técnica estatística utilizada para reduzir a dimensionalidade de conjuntos de dados multivariados. Ele mapeia os pontos de dados em um espaço de dimensão menor, preservando a variação presente nos dados originais. O gráfico resultante do PCA mostra como os pontos de dados estão distribuídos em relação às principais componentes principais.<br>
                O gráfico da Árvore filogenética é um diagrama que ilustra as relações evolutivas entre diferentes espécies ou grupos de organismos. É construído com base em informações genéticas, morfológicas ou outras evidências. O gráfico da árvore filogenética mostra os relacionamentos de ancestralidade e descendência entre as entidades estudadas.<br>
                Por fim, o gráfico de Admixture é um conceito utilizado em genética populacional para descrever a proporção de ancestralidade de uma população proveniente de diferentes grupos ou linhagens ancestrais. O gráfico de admixture mostra a contribuição relativa de cada ancestralidade em uma população estudada, geralmente representada por barras coloridas.</p>

            <p style="font-size: 15px;">Após obtermos os gráficos, realizamos a análise critica entre os gráficos obtidos e os apresentados no artigo. Para essa análise, analisamos a compatibilidade entre os gráficos.</p>   
            <p style="font-size: 15px;">Para começar, iremos realizar a comparação dos gráficos do PCA:</p>
            <img src="Images/PCA 1 - LEAF & FRUIT.png" alt=" " style="float: left;">
            <img src="Images/PCA1 paper.png" alt=" " style="float: right;" width="700" height="500">
            <figcaption style="font-size: 15px;">Figura 3 - Comparação entre os gráficos de PCA <em>Leaf + Fruit</em><br> <a target="_blank" href="Images/legendapc1.png" style="color: #00abf0;">Legenda do PCA realizado pelo RStudio</a></figcaption>
            <br>
            <br>
            <br>
            <img src="Images/PCA 2 - ONLY LEAF.png" alt=" " style="float: left;">
            <img src="Images/PCA2 paper.png" alt=" " style="float: right;" width="700" height="500">
            <figcaption style="font-size: 15px;"> Figura 4 - Comparação entre os gráficos de PCA <em>Only Leaf</em><br> <a target="_blank" href="Images/legenda pca2.png" style="color: #00abf0;">Legenda do PCA realizado pelo RStudio</a></figcaption>
            <br>
            <p style="font-size: 15px;">Após comparar os quatro gráficos, concluímos que não há compatibilidade entre eles. Uma das causas para essa divergência pode ser a diferença dos padrões dos pontos.</p>
            <p style="font-size: 15px;">Em seguida, realizamos a análise critica das árvores filogenéticas:</p>
            <img src="Images/Assignment2_ToyTree.png" alt=" " style="float: left;" width="600" height="500">
            <img src="Images/ArvoreFilo paper.png" alt=" " style="float: right;" width="600" height="500">
            <figcaption style="font-size: 15px;">Figura 5 - Comparação entre as Árvores filogenéticas<br> <a target="_blank" href="Images/Assignment2_ToyTree.svg" style="color: #00abf0;">Para uma melhor visualização da Árovre filogenética realizada pelo ToyTree</a><br> <a target="_blank" href="Images/legenda arvore.png" style="color: #00abf0;">Legenda da árvore do ToyTree</a></figcaption>
            <br>
            <p style="font-size: 15px;">Após analisar os dois gráficos, podemos afirmar que não há compatibilidade entre eles. Uma das causas dessa discrepância pode ter sido o uso de diferentes métodos. Outra possível causa para essa diferença nos resultados pode ter sido as técnicas de inferência utilizadas.</p>
            <p style="font-size: 15px;">Por fim realizamos uma análise critica entre os gráficos de Admixture:</p>
            <img src="Images/admixture.png" alt=" " style="float: left;" width="500" height="300">
            <img src="Images/admixture paper.png" alt=" " style="float: right;" width="700" height="300">
            <figcaption style="font-size: 15px;">Fugura 6 - Comparação entre os gráficos de <em>Admixture</em><br> <a target="_blank" href="Images/admixture dos 4K.html" style="color: #00abf0;">Para uma melhor visualização do gráfico de Admixture realizado pelo ALStructure</a></figcaption>
            <br>
            <p style="font-size: 15px;">Após observar os dois gráficos, chegamos à conclusão de que eles não são compatíveis. Uma das causas que pode ter ocasionado essa diferença é o uso de conjuntos de dados diferentes.</p>

        </div>
    </section>

    <!-- Discussion section design. " " -->
    <section class="discussion" id="discussion">
        <h2 class="heading">Discussion</h2>

        <div class="dis-content">
            <p style="font-size: 15px;"><strong>PCA</strong></p>
            <p style="font-size: 15px;">Temos dois tipos diferentes de PCA. O primeiro PCA é o resultado das espécies <em>LEAF + FRUIT</em>. O segundo PCA é o resultado das espécies <em>ONLY LEAF</em>.</p>
            <p style="font-size: 15px;">Após ter analisado os gráficos do PCA das espécies <em>LEAF + FRUIT</em> na seção de Resultados, podemos identificar algumas diferenças entre os dois gráficos. A primeira diferença está na variância explicada: no nosso gráfico, o PC1 possui uma variância explicada de 36,37%, enquanto no gráfico do artigo original essa variância é de 26,6%. Ou seja, a nossa análise é capaz de explicar 36,37% da variabilidade total dos dados originais. Quanto maior a variância explicada por um componente principal, mais ele captura informações relevantes dos dados. Na comparação da variância explicada no gráfico de PCA das espécies <em>ONLY LEAF</em>, podemos observar que os números entre o gráfico que obtivemos e o gráfico original são praticamente idênticos, mas o nosso gráfico apresenta um valor ligeiramente superior ao do gráfico original. Também podemos notar diferentes distribuições dos pontos nos dois gráficos de PCA que realizamos. Ambos possuem uma distribuição de pontos bastante "aleatória" em comparação com a distribuição dos pontos nos gráficos originais. Também é possível observar que, nos gráficos de PCA que realizamos, ambos possuem escalas diferentes em relação aos gráficos de PCA originais. Isso significa que as variáveis originais têm magnitudes ou unidades de medida distintas. Essa diferença nas escalas pode fazer com que algumas variáveis tenham uma influência maior no resultado do PCA, enquanto outras têm uma influência menor. Como resultado, as distribuições das populações nos gráficos de PCA podem ser diferentes.</p>
            <p style="font-size: 15px;">Algumas hipóteses para explicar as diferenças entre os dois gráficos podem ser o uso de diferentes conjuntos de dados para o cálculo do PCA ou a utilização de métodos distintos para realizar o PCA. O artigo original pode ter utilizado um software diferente do nosso para construir o PCA. Outra possibilidade é a qualidade dos dados utilizados na construção do gráfico. Ou seja, os meus dados podem não ter a mesma qualidade dos dados do artigo original. Além disso, a dimensionalidade dos dados que utilizei para criar o gráfico pode ter sido diferente, ou seja, os meus dados podem ter uma dimensionalidade menor em comparação com os dados do artigo original.</p>
            <p style="font-size: 15px;">Essas diferenças podem ser evitadas se realizarmos revisões nos parâmetros do PCA. É importante revisar e ajustar esses parâmetros para garantir que a análise esteja capturando de forma adequada a variação e as diferenças relevantes nos dados. Outra maneira de mitigar as discrepâncias é utilizar métodos de seleção de variáveis. Isso significa selecionar um conjunto de variáveis mais relevante para o PCA, usando métodos como análise de correlação, análise de importância de características ou algoritmos de seleção automática de variáveis. Essa abordagem pode ajudar a direcionar a análise para as variáveis mais informativas, reduzindo as diferenças nos gráficos do PCA.</p>
            <br>
            <br>
            <p style="font-size: 15px;"><strong>Árvore Filogenética</strong></p>
            <p style="font-size: 15px;">Após analisar a comparação das duas árvores filogenéticas, podemos observar uma grande diferença entre elas. Uma das principais diferenças observadas é a estrutura das árvores filogenéticas. A árvore filogenética realizada neste trabalho possui uma estrutura completamente diferente em comparação com a árvore do artigo. Na árvore filogenética que fizemos, o ancestral comum é a Quercus agrifolia var. oxyadenia, enquanto o ancestral comum na árvore do artigo é a espécie Quercus kelloggii. Além disso, os grupos presentes na nossa árvore estão distribuídos de forma totalmente diferente e pertencem a grupos distintos em relação à árvore do artigo. Por exemplo, as espécies de Quercus kelloggii estão em grupos completamente diferentes na nossa árvore em comparação com a árvore original. No artigo, as espécies de Quercus kelloggii estão todas agrupadas e compartilham um único ancestral comum, enquanto na nossa árvore elas estão em grupos diferentes e compartilham ancestrais comuns distintos. Também podemos observar diferenças nas distâncias entre os ramos. Na nossa árvore, os ramos estão mais distantes uns dos outros em comparação com os ramos da árvore do artigo. Na árvore do artigo, os ramos estão mais próximos uns dos outros. Outra diferença está nos valores de bootstrap dos nós da árvore. Na nossa árvore, os valores de bootstrap são muito menores em comparação com os valores de bootstrap do artigo. O valor máximo de bootstrap dos nós na nossa árvore é 64, enquanto os valores máximos de bootstrap na árvore do artigo chegam a 100, apresentando assim uma grande diferença nos valores.</p>
            <p style="font-size: 15px;">Para essas diferenças, existem várias hipóteses que podem explicar essas disparidades. Uma hipótese é o uso de métodos diferentes. A construção de árvores filogenéticas envolve a utilização de diferentes métodos. Alguns dos métodos mais comuns incluem o método de distância, o método de máxima verossimilhança e o método de inferência bayesiana. Cada método tem suas suposições e limitações, o que pode resultar em árvores filogenéticas diferentes, mesmo quando aplicados aos mesmos dados. Outra hipótese é o uso de diferentes softwares para construir as árvores, como o RaxML, o MrBayes, entre outros. Esses softwares podem ter diferentes versões das que utilizamos. Uma outra hipótese pode ser o uso de diferentes programas para desenhar a árvore. Por exemplo, a árvore do artigo pode ter sido desenhada usando o software FigTree. Outra hipótese é a diferença no uso de técnicas de inferência. As técnicas de inferência utilizadas na construção da árvore filogenética também podem variar. Por exemplo, a seleção de modelos evolutivos, a escolha de critérios de otimização e os métodos de busca heurística podem afetar os resultados obtidos. Pequenas diferenças nas etapas de inferência podem levar a árvores filogenéticas distintas. Outra hipótese para a discrepância nas árvores pode ser a diferença nos dados de entrada. A qualidade e a quantidade dos dados de entrada podem influenciar as árvores filogenéticas resultantes. Diferenças nas sequências de DNA, regiões genômicas selecionadas ou inclusão/exclusão de determinadas espécies podem levar a resultados distintos. Além disso, erros de amostragem, falta de dados ou dados de baixa qualidade podem afetar a precisão das árvores filogenéticas.</p>
            <p style="font-size: 15px;">Essas diferenças entre as duas árvores podem ser resolvidas através da revisão dos métodos de inferência. A escolha dos métodos de inferência utilizados na construção das árvores filogenéticas pode ter um impacto significativo nos resultados. Portanto, é recomendado que revisemos e comparemos diferentes métodos, como métodos baseados em distância, máxima verossimilhança ou inferência bayesiana, para verificar a consistência dos resultados entre eles. Além disso, considerar métodos de bootstrap ou testes de suporte estatístico pode ajudar a avaliar a robustez das relações filogenéticas estimadas. Outro método para prevenir tais diferenças é a revisão dos critérios de seleção de modelos. A escolha adequada de modelos evolutivos é crucial para a construção de árvores filogenéticas precisas. Diferentes modelos podem se ajustar melhor a diferentes conjuntos de dados e cenários evolutivos. Portanto, é importante revisar os critérios de seleção de modelos, como o Critério de Informação de Akaike (AIC) ou o Critério de Informação Bayesiana (BIC), para identificar o modelo que melhor se ajusta aos dados e reduzir as diferenças entre as árvores filogenéticas.</p>
            <br>
            <br>
            <p style="font-size: 15px;"><strong>Admixture</strong></p>
            <p style="font-size: 15px;">No artigo original, as espécies são abordadas no gráfico admixture para diferentes valores de K, ao contrário do nosso projeto, onde abordamos todas as espécies para todos os valores de K (K=2, K=3 e K=4), contudo para fazer uma comparação justa iremos apenas analisar os valores de K de cada espécie abrangidos em ambos os artigos.</p>
            <p style="font-size: 15px;">Começando pelos Híbridos, uma vez que no artigo original apenas são atingidos pelo valor de K=3, a analise vai incidir apenas nesse valor de K, no caso do nosso gráfico Admixture, é possível identificar presença de todos os K, sendo que K2 tem consideravelmente menos representação do que K0 e K1, indicando que esses clusters apresentam maior contribuição proporcional para as espécies de Híbridos. No caso do artigo original é possível identificar uma situação semelhante e também que como a contribuição de ancestralidade de ambos os fatores é de aproximadamente 50%, podemos inferir que há uma grande possibilidade de os ancestrais destas espécies pertencem a espécies diferentes entre si.<br>Em seguidas os Quercus parvula, abordados para K=2 e K=3, no caso do artigo original, temos que para ambos os valores de K, a proporção ancestral desta espécie é, na sua grande maioria, justificada por apenas um fator, indicando que os membros ancestrais desta espécie pertencem à mesma espécie. No caso do nosso gráfico admixture, tanto para K=2 quanto para K=3 apresentam proporções semelhantes, tendo o fator K0, uma proporção significativa da justificação da ancestralidade desta espécie, indicando, como no caso do artigo original que a espécie Quercus parvula tem a sua ancestralidade a consistir na sua maioria da junção de indivíduos da mesma espécie.</p>
            <p style="font-size: 15px;">Para o caso da espécie Quercus var tamalpaisensis, abrangida por K=2 e K=3, temos que, para K=3 a proporção de ancestralidade é de 100% para um fator e para o caso de K=2, tem uma situação semelhante, contudo um fator não representa 100% da proporção ancestral mas apresenta a grande maioria da proporção. No gráfico que produzimos, para K=2, temos proporções dissimilares, existe uma proporção ancestral de 100% numa das tiras enquanto nas outras duas ambos os fatores representam proporções similares o que pode indicar que uma das amostras pertence a um subgrupo da mesma espécie onde ambos os parentes ancestrais pertencem à mesma espécie enquanto nos outros subgrupos os parentes ancestrais são de espécies diferentes. Para K=3 temos uma situação praticamente idêntica tendo apenas como diferença o surgimento de um terceiro fator a ocupar uma proporção menor que 1%.</p>
            <p style="font-size: 15px;">Para a espécie Quercus wislizeni, no artigo original temos uma representação para K=2 e K=3, tanto para K=2 e para K=2 apresenta uma proporção ancestral de praticamente 100% para um dos fatores, sendo isso um forte indicador de que as espécies ancestrais se replicaram com indivíduos da mesma espécie. No caso do nosso gráfico temos também situações semelhantes entre K=2 e K=3 sendo que para K=2 existe uma proporção semelhante entre os fatores, mas tendo o K0 como o fator a ocupar mais proporção ancestral, no caso de K=3 a situação idêntica mas com um terceiro fator K2 com uma proporção de menos de 1%, tendo as mesmas implicações mencionadas no caso do artigo original.</p>
            <p style="font-size: 15px;">Em seguida, a espécie Quercus agrifolia, tem representação para K=3 e K=4, sendo que para K=3 do artigo original temos a proporção ancestral a pertencer 100% ao mesmo fator, indicando de novo a replicação entre ancestrais da mesma espécie. Para K=4 o caso é predominantemente igual tendo como exceção 6 casos que apresentam também proporções de 100% para um único fator, contudo são fatores diferentes entre si o que pode indicar subgrupos onde a presença de subespécies de Quercus agrifolia se replicam predominantemente entre si. Já no caso do nosso gráfico admixture temos que, para K=3, a proporção ancestral desta espécie é composta predominantemente pelo fator K0, tendo apenas uma exceção com um fator com maior proporção ancestral de K1. Para K=4 temos uma situação parecida à descrita anterior, contudo existiu um aumento significativo na proporção ancestral do fator K2 o que pode indicar que com o aumento de cluster podemos observar o subgrupo K2 a aumentar a sua proporção.</p>
            <p style="font-size: 15px;">Por fim, para a espécie Quercus kelloggii, representada em K=2 e K=3, para K=2 temos que, no paper original, um dos fatores é predominante, tendo uma proporção ancestral maioritariamente de 100%, com exceção de um caso onde é o oposto, indicando de novo a possível existência de um subgrupo numa das regiões onde foram recolhidas as amostras. Para K=3 todos os casos têm uma proporção de 100% do mesmo fator indicando uma ancestralidade composta por indivíduos da mesma espécie. No caso do nosso admixture temos tanto para K=2 quanto para K=3, esta espécie tem uma proporção ancestral composta maioritariamente pelo fator K0.</p>
            <p style="font-size: 15px;">Os resultados são diferentes entre o gráfico admixture que foi produzido para este projeto e o do artigo original, uma das hipóteses é, como indicado como causa na seção dos Resultados, pode dar-se devido à diferença dos tamanhos dos data sets utilizados, sendo que no artigo original foi utilizado um data set composto por 43 amostras e o nosso data set era composto por 55 amostras. Outra hipótese que pode justificar estas diferenças é o facto de terem sido usados softwares diferentes para as análises, sendo que no artigo original foi utilizada a ferramenta pyrad e no nosso projeto utilizamos a ferramenta ipyrad, tendo como outputs ficheiros diferentes.</p>
            <p style="font-size: 15px;">Uma forma de prevenir estas discrepâncias nos resultados é, por exemplo, utilizar um data set com o tamanho idêntico ao do artigo original e também usar os mesmos softwares para obter ficheiros iguais para utilizar na task de Structure.</p>

        </div>
    </section>

    <script src="js/script.js"></script>
</body>
</html>